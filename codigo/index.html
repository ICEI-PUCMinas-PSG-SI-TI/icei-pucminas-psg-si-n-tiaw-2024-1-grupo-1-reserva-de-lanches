<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Menu da Lanchonete</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>

<body>
    <div class="container">
        <h1>Menu da Lanchonete</h1>

        <!-- Botões de filtro -->
        <div class="filters">
            <button onclick="showCarrinho('assets/html/finalizarPedido.html')">Ver Carrinho</button>
            <button onclick="filterItems('Doces', 'Bebidas')">Salgados</button>
            <button onclick="filterItems('Doces', 'Comidas')">Bebidas</button>
            <button onclick="filterItems('Comidas', 'Bebidas')">Doces</button>
        </div>
        <div></div>
        <!-- Itens do menu -->
        <div id="menu-items">
            <h2>Comidas</h2>
            <div class="menu-category items-cards" id="Comidas"></div>

            <script>

                 let dbMock = {
                    tipo: ['Comidas', 'Bebidas', 'Doces'],
                    proximoID: 20,
                    items: [
                        {
                            id: 1,
                            tipo: 'Comidas',
                            descricao: 'Sanduíche Natural',
                            preco: 6.50,
                            estoque: 5,
                            img: 'https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhkoNbV9SkABi_6ZnMjxIiqKDdvyI7hNpewpmvezY_WAHgIa18cSYI9-iEFKPEA5Gab_eIEXjoWZX1hid6SsGLsU57IsfdVzT3xi7oBIarwUFLMJ4R4D7vfCvKh_UG5dIC1PNa_MSplPVdvO0VLqeIVmFTd82YZuKExqtBk8wF6Yv79NBRbvTzsXFed/s2000/receita-de-sandu%C3%ADche-natural-light.jpg"'
                        },
                        {
                            id: 2,
                            tipo: 'Comidas',
                            descricao: 'Coxinha',
                            preco: 6.50,
                            estoque: 15,
                            img: 'https://th.bing.com/th/id/R.8195acd4602f690432d2219418cef287?rik=1DUVRcQMjv0K9g&riu=http%3a%2f%2freceitas.net%2fwp-content%2fuploads%2f2017%2f10%2fcoxinha-de-frango-1024x695.jpg&ehk=hNBqU7g3n9XkMWhlGLFgHln5G7kTWtZvPdLMTD3gY0s%3d&risl=&pid=ImgRaw&r=0'
                        },
                        {
                            id: 3,
                            tipo: 'Comidas',
                            descricao: 'Empada',
                            preco: 6.50,
                            estoque: 10,
                            img: 'https://2.bp.blogspot.com/-hEHgTOrhKSk/T41V5A6v1nI/AAAAAAAAACk/2VECbSy0__M/s1600/empada.jpg'
                        },
                        {
                            id: 4,
                            tipo: 'Comidas',
                            descricao: 'Pão de Queijo',
                            preco: 3.00,
                            estoque: 15,
                            img: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQWRhbL3UnDr7fe6-A6_msYI-Qo8UtHtO1xrQ&s'
                        },
                        {
                            id: 5,
                            tipo: 'Comidas',
                            descricao: 'Pão de Queijo Recheado',
                            preco: 5.00,
                            estoque: 10,
                            img: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRbaV-12-rJkimIgGe20CPLUxxAoGGNcrRAYQ&s'
                        },
                        {
                            id: 6,
                            tipo: 'Comidas',
                            descricao: 'Pastel Assado',
                            preco: 6.50,
                            estoque: 10,
                            img: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ7cmen4IT5oFYEmneiSOE8drNZZsS7mhrBMA&s'
                        },
                        {
                            id: 7,
                            tipo: 'Comidas',
                            descricao: 'Hamburgão',
                            preco: 8.00,
                            estoque: 5,
                            img: 'https://i.ytimg.com/vi/-STkr9JS6pA/mqdefault.jpg'
                        },
                        {
                            id: 8,
                            tipo: 'Comidas',
                            descricao: 'Enrolado de Presunto e Queijo',
                            preco: 6.50,
                            estoque: 10,
                            img: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT0VcQ7tDl4pJIFLC942txDBjoZyKBgQ7PRLHSZjgA7ZmahUjorEwAgjI-TAOEDvMOlLRQ&usqp=CAU'
                        },
                        {
                            id: 9,
                            tipo: 'Comidas',
                            descricao: 'Enrolado de Salsicha',
                            preco: 6.50,
                            estoque: 5,
                            img: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTzKn_3-QE63FNtqQuejcM5artPx_UJ1YaKeA&s'
                        },
                        {
                            id: 10,
                            tipo: 'Comidas',
                            descricao: 'Hambúrguer',
                            preco: 12.00,
                            estoque: 5,
                            img: 'https://www.perdigao.com.br/assets/_images/654bfd759bf743d8e6e420cd097f94745da24bc7.png'
                        },
                        {
                            id: 11,
                            tipo: 'Comidas',
                            descricao: 'Batata Frita',
                            preco: 15.00,
                            estoque: 5,
                            img: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT5t7mL44se71Kw089vf99YG9_3PYQowHpFdg&s'
                        },
                        {
                            id: 12,
                            tipo: 'Bebidas',
                            descricao: 'Refrigerantes',
                            preco: 6.00,
                            estoque: 30,
                            img: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQmycCQRo4JsPvVyFKqQBk0pmD9LWsP1pKu9w&s'
                        },
                        {
                            id: 13,
                            tipo: 'Bebidas',
                            descricao: 'Sucos',
                            preco: 6.50,
                            estoque: 20,
                            img: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTq0-69gl2VtvQSUA9AouJHYi1uWL7YNL527Q&s'
                        },
                        {
                            id: 14,
                            tipo: 'Bebidas',
                            descricao: 'Vitaminas',
                            preco: 7.50,
                            estoque: 20,
                            img: 'https://www.guiadasemana.com.br/contentFiles/image/2019/05/FEA/galeria/52849_w840h525_1558996048shutterstock-1237794556.jpg'
                        },
                        {
                            id: 15,
                            tipo: 'Bebidas',
                            descricao: 'Água',
                            preco: 4.50,
                            estoque: 50,
                            img: 'https://abir.org.br/abir/wp-content/uploads/2020/09/WhatsApp-Image-2020-09-30-at-15.26.58.jpeg'
                        },
                        {
                            id: 16,
                            tipo: 'Bebidas',
                            descricao: 'Energético',
                            preco: 12.00,
                            estoque: 15,
                            img: 'https://th.bing.com/th?id=OSK.HEROdcF23LjpLGIEo4Lk0MYDJrEZ9euas7qCH_jaxJniP-4&w=384&h=228&c=13&rs=2&o=6&pid=SANGAM'
                        },
                        {
                            id: 17,
                            tipo: 'Doces',
                            descricao: 'Bombom',
                            preco: 3.00,
                            estoque: 50,
                            img: 'https://casabrasileira.ch/wp-content/uploads/2020/06/636.jpg'
                        },
                        {
                            id: 18,
                            tipo: 'Doces',
                            descricao: 'Balas',
                            preco: 0.25,
                            estoque: 100,
                            img: 'https://www.revistaartesanato.com.br/wp-content/uploads/2019/07/como-montar-mesa-de-doce-5.jpg'
                        },
                        {
                            id: 19,
                            tipo: 'Doces',
                            descricao: 'Chicletes',
                            preco: 2.50,
                            estoque: 50,
                            img: 'https://http2.mlstatic.com/D_NQ_NP_2X_941045-MLB31840481365_082019-F.jpg'
                        },
                    ]
                };
       
                let db = []
                let hasAnyProdInCart = false
                setDbProdutos();
                console.log(db)

                function showCarrinho(url) {
                    if (hasAnyProdInCart) {
                        window.location.href = url;
                    } else {
                        alert('carrinho vazio')
                    }
                }

                function filterItems(hidde1, hidde2) {
                    let parent = document.querySelector('.items-cards')
                    let childrenArray = Array.from(parent.children)

                    childrenArray.forEach(o => {
                        if (!o.classList.contains(hidde1) && !o.classList.contains(hidde2) || o.classList.contains('hidden')) {
                            o.classList.remove('hidden')
                        }
                        else {
                            o.classList.add('hidden')
                        }
                    })
                }

                function setDbProdutos() {
                    dbProdutos = JSON.parse(localStorage.getItem('dbProdutos')) || [];

                        dbProdutos = dbMock.items;
                        localStorage.setItem('dbProdutos', JSON.stringify(dbProdutos));
                        console.log(dbProdutos)

                        fillDbProducts();
                }

                function fillDbProducts() {
                    let data = JSON.parse(localStorage.getItem('dbProdutos')) || [];

                    db = data;

                    fillProductsCards()
                }

                function fillProductsCards() {
                    let divMenu = document.querySelector('.items-cards')

                    db.forEach(o => {
                        divMenu.appendChild(createCards(o))
                    })

                }

                function createCards(data) {
                    let div = document.createElement('div');
                    div.classList.add('menu-item');
                    div.classList.add(`${data.tipo}`)
                    div.classList.add(data.tipo);
                    div.id = `${data.id}`;
                    div.innerHTML = `
                        <img src="${data.img}" alt="Enrolado de Salsicha">
                        <div class="menu-item-content">
                            <h2>${data.descricao}</h2>
                            <p>Valor: R$ ${data.preco}</p>
                        </div>
                        <button class="add-to-cart-btn">Adicionar ao carrinho</button>
                    `;

                    let addToCartButton = div.querySelector('.add-to-cart-btn');
                    addToCartButton.addEventListener('click', function () {
                        addToCart(div.id);
                    });
                    return div;
                }

                function addToCart(productId) {
                    let id = parseInt(productId)
                    let product = db.find(o => o.id === id);

                    if (product) {
                        let cart = JSON.parse(sessionStorage.getItem('cart')) || [];

                        cart.push(product);
                        if (cart.length > 0) {
                            hasAnyProdInCart = true;
                        } else {
                            hasAnyProdInCart = false;
                        }
                        sessionStorage.setItem('cart', JSON.stringify(cart));

                        console.log(`Product ID ${productId} added to cart`);
                    } else {
                        console.log(`Product ID ${productId} not found`);
                    }
                }

                function calculateTotal() {
                    let total = 0;
                    const items = document.querySelectorAll('.menu-item-content');
                    items.forEach(item => {
                        const price = parseFloat(item.querySelector('p').textContent.replace('Valor: R$', '').trim());
                        const quantity = parseInt(item.querySelector('select').value);
                        total += price * quantity;
                    });
                    return total;
                }

                function showSummary() {
                    const summary = document.getElementById('order-summary');
                    let orderSummary = "Resumo do Pedido:\n";
                    const items = document.querySelectorAll('.menu-item-content');
                    items.forEach(item => {
                        const itemName = item.querySelector('h2').textContent;
                        const quantity = parseInt(item.querySelector('select').value);
                        if (quantity > 0) {
                            orderSummary += `${itemName}: ${quantity}x\n`;
                        }
                    });
                    summary.textContent = orderSummary;

                    const totalPrice = calculateTotal();
                    document.getElementById('total-price').textContent = `Total: R$${totalPrice.toFixed(2)}`;
                }

                    </script>

</body>

</html>